import{_ as s,o as a,c as n,V as l}from"./chunks/framework.0020f959.js";const C=JSON.parse('{"title":"ä¸Šä¼ æ–‡ä»¶base64æµè½¬formData","description":"","frontmatter":{"title":"ä¸Šä¼ æ–‡ä»¶base64æµè½¬formData","date":"2022-08-15T00:00:00.000Z","tags":["javascript","éšç¬”"],"categories":["javascript"]},"headers":[],"relativePath":"blogs/javascript/base64ToFormData.md","lastUpdated":1685957522000}'),p={name:"blogs/javascript/base64ToFormData.md"},o=l(`<h2 id="å‰è¨€" tabindex="-1">å‰è¨€ <a class="header-anchor" href="#å‰è¨€" aria-label="Permalink to &quot;å‰è¨€&quot;">â€‹</a></h2><p>å‰å‡ å¤©åœ¨é¡¹ç›®ä¸­é‡åˆ°ä¸€ä¸ªä»¥å‰éƒ½æ²¡æœ‰æ¥è§¦è¿‡çš„é—®é¢˜ï¼Œè§‰å¾—å¾ˆæœ‰æ„æ€è®°å½•ä¸€ä¸‹</p><p>åœºæ™¯æ˜¯è¿™æ ·çš„</p><p>æˆ‘ä»¬é¡¹ç›®ä¸­æœ‰ä¸€ä¸ªè¯­éŸ³ä¸Šä¼ ï¼ˆç”¨çš„elmentçš„uploadç»„ä»¶ï¼‰ï¼Œè¿™ä¸ªè¯­éŸ³ä¸Šä¼ æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><pre><code>- 1ã€ç›´æ¥é€‰æ‹©æ–‡ä»¶ä¸Šä¼ ï¼›

- 2ã€è¾“å…¥æ–‡å­—ï¼Œåˆ©ç”¨TTSèƒ½åŠ›è½¬ä¸ºè¯­éŸ³ï¼Œç„¶ååœ¨ä¸Šä¼ ã€‚
</code></pre><p>æ˜¯ä¸æ˜¯çœ‹èµ·æ¥éƒ½æŒºæ­£å¸¸çš„ğŸ¥²ï¼Œä½†æ˜¯é—®é¢˜å°±å‡ºåœ¨ï¼ŒTTSèƒ½åŠ›ä¸æ˜¯è‡ªå·±å…¬å¸çš„ï¼Œå®ƒè¿”å›çš„æ˜¯ä¸€ä¸ª<code>base64</code>æµï¼Œè¿™æ ·å°±å¯¼è‡´å…ˆå‰çš„ä¸Šä¼ æ¥å£ä¸æ”¯æŒï¼ˆå› ä¸ºå®ƒæ˜¯ç›´æ¥æ¥æ”¶<code>FormData</code>çš„ï¼Œä¸æ”¯æŒ<code>base64</code>çš„ï¼‰ï¼Œç»è¿‡ä¸€æ®µæ—¶é—´çš„ï¼ˆ<s>ç™¾åº¦</s>ï¼‰æ€è€ƒï¼Œå¾—å‡ºä¸‹åˆ—çš„æ€è·¯ï¼š</p><p>1.å°†base64æ ¼å¼çš„å›¾ç‰‡å¤„ç†ä¸ºBlobå¯¹è±¡ã€‚ 2.å°†Blobå¯¹è±¡æ·»åŠ åˆ°formDataå¯¹è±¡ä¸­ã€‚ 3.httpè¯·æ±‚å¤´è®¾ç½®ä¸ºcontext-type: multipart/form-dataä¸Šé€åˆ°æ–‡ä»¶æœåŠ¡å™¨ã€‚</p><h3 id="å®ç°" tabindex="-1">å®ç° <a class="header-anchor" href="#å®ç°" aria-label="Permalink to &quot;å®ç°&quot;">â€‹</a></h3><div class="language-javascript"><button title="Copy Code" class="copy"></button><span class="lang">javascript</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">/*base64æ–‡ä»¶æµ*/</span></span>
<span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> base64String</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// å¤„ç†base64æ–‡ä»¶æµ</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">base64String</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//è¿™é‡Œå¯¹base64ä¸²è¿›è¡Œæ“ä½œï¼Œå»æ‰urlå¤´ï¼Œå¹¶è½¬æ¢ä¸ºbyte</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">bstr</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">atob</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">base64String</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">split</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">,</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)[</span><span style="color:#F78C6C;">1</span><span style="color:#F07178;">]) </span><span style="color:#676E95;font-style:italic;">// ä½¿ç”¨atob() å°†base64 è½¬ä¸ºæ–‡æœ¬æ–‡ä»¶</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">let</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">n</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">bstr</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">length</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">u8arr</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Uint8Array</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">n</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// åˆ›å»ºä¸€ä¸ªäºŒè¿›åˆ¶æ•°æ®ç¼“å†²åŒºï¼Œå¯ä»¥ç†è§£ä¸ºä¸€ä¸ªæ•°ç»„</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">while</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">n</span><span style="color:#89DDFF;">--</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#A6ACCD;">u8arr</span><span style="color:#F07178;">[</span><span style="color:#A6ACCD;">n</span><span style="color:#F07178;">] </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">bstr</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">charCodeAt</span><span style="color:#F07178;">(</span><span style="color:#A6ACCD;">n</span><span style="color:#F07178;">) </span><span style="color:#676E95;font-style:italic;">// å°†æ–‡æœ¬æ–‡ä»¶è½¬ä¸ºUTF-16çš„ASCII, æ”¾åˆ°ç±»å‹åŒ–æ•°ç»„å¯¹è±¡ä¸­</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">//Blobå¯¹è±¡</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">blob</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">Blob</span><span style="color:#F07178;">([</span><span style="color:#A6ACCD;">u8arr</span><span style="color:#F07178;">]</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span><span style="color:#F07178;"> type</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">audio/wav</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// FormDataå¯¹è±¡</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fd</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">new</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">FormData</span><span style="color:#F07178;">()</span></span>
<span class="line"><span style="color:#89DDFF;">    </span><span style="color:#676E95;font-style:italic;">// æŠŠæ–‡ä»¶è¿½åŠ åˆ°FormDataå¯¹è±¡ä¸­</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">fd</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">append</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">autoCall_file</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">blob</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">Date</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">now</span><span style="color:#F07178;">() </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">.wav</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">fd</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// ä¸Šä¼ åˆ°æœåŠ¡å™¨</span></span>
<span class="line"><span style="color:#C792EA;">function</span><span style="color:#A6ACCD;"> </span><span style="color:#82AAFF;">httpRequest</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">formData</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;font-style:italic;">return</span><span style="color:#F07178;"> </span><span style="color:#82AAFF;">axios</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">        method</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">post</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        url</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">xxxxx</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// ä½ çš„æ–‡ä»¶æœåŠ¡å™¨åœ°å€</span></span>
<span class="line"><span style="color:#F07178;">        data</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">formData</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        timeout</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">formData</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        headers</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">Content-Type</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">multipart/form-data</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// è¯·æ±‚å¤´è¦è®¾ç½®ä¸º form-data</span></span>
<span class="line"><span style="color:#F07178;">            </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">Cache-Control</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">:</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">no-cache</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span></span>
<span class="line"><span style="color:#F07178;">        </span><span style="color:#89DDFF;">},</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#89DDFF;">}</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span></code></pre></div><p>ä¸å¾—ä¸è¯´ï¼Œæ´»åˆ°è€å­¦åˆ°è€ï¼Œæ¯æ¬¡æ¥è§¦æ–°çŸ¥è¯†éƒ½æ˜¯æ»¡æ»¡çš„åŠ¨åŠ›</p>`,10),t=[o];function e(c,r,F,y,D,i){return a(),n("div",null,t)}const d=s(p,[["render",e]]);export{C as __pageData,d as default};
