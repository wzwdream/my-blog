import{_ as s,o as a,c as n,V as l}from"./chunks/framework.0020f959.js";const C=JSON.parse('{"title":"iframeä¹‹é—´çš„é€šä¿¡","description":"","frontmatter":{"title":"iframeä¹‹é—´çš„é€šä¿¡","date":"2023-02-15T00:00:00.000Z","tags":["javascript","éšç¬”"],"categories":["javascript"]},"headers":[],"relativePath":"blogs/informal-essay/iframe.md","lastUpdated":1681976015000}'),o={name:"blogs/informal-essay/iframe.md"},p=l(`<h2 id="å‰è¨€" tabindex="-1">å‰è¨€ <a class="header-anchor" href="#å‰è¨€" aria-label="Permalink to &quot;å‰è¨€&quot;">â€‹</a></h2><p><code>iframe</code> æƒ³å¿…å¤§å®¶éƒ½æŒºç†Ÿæ‚‰çš„äº†ï¼Œå°±ä¸å¤šè¯´äº†ğŸ‘ğŸ‘ã€‚å†™è¿™ç¯‡æ–‡ç« çš„åˆè¡·ä¸»è¦æ˜¯ä¸°å¯Œè‡ªå·±çš„çŸ¥è¯†å’Œè§£å†³é‡åˆ°çš„é—®é¢˜ã€‚å› ä¸ºæˆ‘åŸºæœ¬ä¸Šæ²¡æ¥è§¦è¿‡ <code>iframe</code> ï¼Œæ‰€ä»¥å¯¹å®ƒçš„é€šä¿¡æ–¹å¼ä¸æ˜¯å¾ˆäº†è§£ã€‚å‰å‡ å¤©ï¼Œè·Ÿæˆ‘çš„ä¸€ä¸ªæœ‹å‹ï¼ˆ<a href="https://juejin.cn/user/2032320262973112" target="_blank" rel="noreferrer">åœ¨ä¸‹æ¨å…¬å­</a>ï¼‰èŠå¤©æ—¶ï¼Œä»–æåˆ°äº† <code>iframe</code> çš„é€šä¿¡æ–¹å¼ï¼Œæˆ‘è§‰å¾—å¾ˆæœ‰æ„æ€ï¼Œå°±å¼€å§‹äº†è§£å’Œå­¦ä¹ ã€‚åœ¨è¿™ç¯‡æ–‡ç« ä¸­ï¼Œæˆ‘å°†åˆ†äº«æˆ‘æ‰€å­¦åˆ°çš„å†…å®¹ï¼Œå¸Œæœ›å¯¹å¤§å®¶æœ‰æ‰€å¸®åŠ©ğŸ¤ªğŸ¤ªã€‚</p><p>æ¥ä¸‹æ¥æˆ‘ä»¬å°±ä¸€èµ·æ¥å­¦ä¹ ä¸€ä¸‹å…³äº <code>iframe</code> é€šä¿¡çš„ç›¸å…³çŸ¥è¯†å§ğŸ˜</p><h2 id="iframeé€šä¿¡çš„å‡ ç§æ–¹å¼ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸" tabindex="-1">iframeé€šä¿¡çš„å‡ ç§æ–¹å¼ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸ <a class="header-anchor" href="#iframeé€šä¿¡çš„å‡ ç§æ–¹å¼ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸" aria-label="Permalink to &quot;iframeé€šä¿¡çš„å‡ ç§æ–¹å¼ğŸ˜¶â€ğŸŒ«ï¸ğŸ˜¶â€ğŸŒ«ï¸&quot;">â€‹</a></h2><ol><li><strong>URL ä¼ å‚</strong>ï¼šçˆ¶çª—å£å¯ä»¥é€šè¿‡åœ¨ iframe çš„ src å±æ€§åæ·»åŠ å‚æ•°æ¥å‘å­çª—å£ä¼ é€’æ•°æ®ï¼Œå­çª—å£å¯ä»¥é€šè¿‡ <code>location.search</code> æˆ– <code>location.hash</code> æ¥è·å–å‚æ•°âœ¨âœ¨ã€‚</li></ol><ul><li>ä½¿ç”¨ <code>?</code> æ‹¼æ¥å‚æ•°ï¼Œå­é¡µé¢ä½¿ç”¨ <code>location.search</code> æ¥æ”¶å‚æ•°</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// parent.html</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">iframe</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">iframe1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./child1.html?name=æ¥è‡ªparentçš„æ¶ˆæ¯</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">frameborder</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">iframe</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// child1.html</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">  console.log(window.decodeURIComponent(location.search)) // ?name=æ¥è‡ªparentçš„æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><ul><li>ä½¿ç”¨ <code>#</code> æ‹¼æ¥å‚æ•°ï¼Œå­é¡µé¢ä½¿ç”¨ <code>location.hash</code> æ¥æ”¶å‚æ•°ï¼ŒåŒæ—¶è¿˜å¯ä»¥ä½¿ç”¨ <code>window.onhashchange</code> æ¥ç›‘å¬å‚æ•°çš„å˜åŒ–ã€‚</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#676E95;font-style:italic;">// parent.html</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">iframe</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">id</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">iframe1</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">src</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">./child1.html#name=æ¥è‡ªparentçš„æ¶ˆæ¯</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;"> </span><span style="color:#C792EA;">frameborder</span><span style="color:#89DDFF;">=</span><span style="color:#89DDFF;">&quot;</span><span style="color:#C3E88D;">0</span><span style="color:#89DDFF;">&quot;</span><span style="color:#89DDFF;">&gt;&lt;/</span><span style="color:#F07178;">iframe</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">const iframe1 = document.getElementById(&#39;iframe1&#39;)</span></span>
<span class="line"><span style="color:#A6ACCD;">// åœ¨2såæ›´æ”¹hash</span></span>
<span class="line"><span style="color:#A6ACCD;">setTimeout(() =&gt; </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    iframe1</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">src </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">./child1.html#age=12</span><span style="color:#89DDFF;">&#39;</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">, 2000)</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#676E95;font-style:italic;">// child1.html</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span>
<span class="line"><span style="color:#A6ACCD;">console.log(&#39;hash&#39;, window.decodeURIComponent(location.hash)) // #name=æ¥è‡ªparentçš„æ¶ˆæ¯</span></span>
<span class="line"><span style="color:#A6ACCD;">window.onhashchange = () =&gt; </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#A6ACCD;">    console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">hashchange</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">location</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">hash) </span><span style="color:#676E95;font-style:italic;">// #age=12</span></span>
<span class="line"><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">&lt;/</span><span style="color:#F07178;">script</span><span style="color:#89DDFF;">&gt;</span></span></code></pre></div><blockquote><p>âš¡âš¡éœ€è¦æ³¨æ„çš„æ˜¯é€šè¿‡ <code>URL ä¼ å‚</code> çš„æ—¶å€™ï¼Œä¼ è¾“æºå¸¦ä¸­æ–‡çš„è¯ï¼Œè®°å¾—ä½¿ç”¨ <code>decodeURIComponent</code> è¿›è¡Œè§£ç ã€‚</p></blockquote><ol start="2"><li><strong>window.postMessage</strong>ï¼šå®‰å…¨ã€å¯é ä¸”æ”¯æŒè·¨åŸŸçš„ iframe é€šä¿¡æ–¹å¼ï¼Œå®ƒå¯ä»¥åœ¨ä¸¤ä¸ªçª—å£ä¹‹é—´å¼‚æ­¥ä¼ é€’æ¶ˆæ¯âœ¨âœ¨âœ¨âœ¨âœ¨ã€‚</li></ol><ul><li>åœ¨å‘é€æ–¹ä¸­ï¼Œä½¿ç”¨Â <code>window.postMessage()</code>Â æ–¹æ³•å‘å¦ä¸€ä¸ªçª—å£å‘é€æ¶ˆæ¯ã€‚è¯¥æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šè¦å‘é€çš„æ¶ˆæ¯å’Œç›®æ ‡çª—å£çš„æºï¼ˆä¾‹å¦‚ï¼Œ<code>&quot;http://127.0.0.1:5500/child.html&quot;</code>Â æˆ–Â <code>&quot;*&quot;</code>ï¼‰ã€‚</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">postMessage</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Hello world!</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://127.0.0.1:5500/child.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><ul><li>åœ¨æ¥æ”¶æ–¹ä¸­ï¼Œä½¿ç”¨Â <code>window.addEventListener()</code>Â æ–¹æ³•ç›‘å¬Â <code>message</code>Â äº‹ä»¶ã€‚è¯¥äº‹ä»¶å¯¹è±¡åŒ…å«ä¸‰ä¸ªå±æ€§ï¼š<code>data</code>Â è¡¨ç¤ºæ¥æ”¶åˆ°çš„æ•°æ®ï¼Œ<code>origin</code>Â è¡¨ç¤ºå‘é€æ–¹çš„æºï¼Œ<code>source</code>Â è¡¨ç¤ºå‘é€æ–¹çª—å£çš„å¼•ç”¨ã€‚</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">addEventListener</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">message</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">(</span><span style="color:#A6ACCD;font-style:italic;">event</span><span style="color:#89DDFF;">)</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#89DDFF;">  </span><span style="color:#676E95;font-style:italic;">// åˆ¤æ–­æ¶ˆæ¯æ˜¯å¦æ¥è‡ªå¯ä¿¡ä»»çš„æº</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;font-style:italic;">if</span><span style="color:#F07178;"> (</span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">origin</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">===</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://127.0.0.1:5500/child.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;">) </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">    </span><span style="color:#A6ACCD;">console</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">message: </span><span style="color:#89DDFF;">&#39;</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">+</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">event</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">data</span><span style="color:#F07178;">)</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#89DDFF;">}</span></span>
<span class="line"><span style="color:#89DDFF;">}</span><span style="color:#A6ACCD;">)</span></span></code></pre></div><p><strong>å…¼å®¹æ€§</strong>ï¼Œæ¥è‡ª <a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Window/postMessage#%E6%B5%8F%E8%A7%88%E5%99%A8%E5%85%BC%E5%AE%B9%E6%80%A7" target="_blank" rel="noreferrer">window.postMessage | MDN</a></p><p><img src="https://p1-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/f49102949b224b579f43b71e7e0f5aba~tplv-k3u1fbpfcp-watermark.image?" alt="image.png"></p><ol start="3"><li><strong>window.name</strong>ï¼šå¯ä»¥ä½¿ç”¨ä¸€ä¸ªéšè—çš„iframeå’Œwindow.nameå±æ€§åœ¨ä¸åŒçš„çª—å£ä¹‹é—´å…±äº«æ•°æ®âœ¨âœ¨ã€‚</li></ol><ul><li>åœ¨å­é¡µé¢ä¸­ï¼Œå°†è¦ä¼ é€’ç»™çˆ¶é¡µé¢çš„æ•°æ®ä¿å­˜åœ¨Â <code>window.name</code>Â å±æ€§ä¸­ã€‚</li></ul><p>ä¾‹å¦‚</p><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">window</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">name </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">Hello Parent!</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span></code></pre></div><ul><li>åœ¨çˆ¶é¡µé¢ä¸­ï¼Œåˆ›å»ºä¸€ä¸ªéšè—çš„ iframe å…ƒç´ ï¼Œå¹¶ä¸”å°†å…¶æºè®¾ç½®ä¸º<code>å­é¡µé¢çš„ URL</code>ã€‚</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#C792EA;">const</span><span style="color:#A6ACCD;"> iframe </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> document</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">createElement</span><span style="color:#A6ACCD;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">iframe</span><span style="color:#89DDFF;">&#39;</span><span style="color:#A6ACCD;">)</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">iframe</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">style</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">display </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">none</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">iframe</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">src </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">http://127.0.0.1:5500/child1.html</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#A6ACCD;">document</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">body</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">appendChild</span><span style="color:#A6ACCD;">(iframe)</span><span style="color:#89DDFF;">;</span></span></code></pre></div><ul><li>åœ¨çˆ¶é¡µé¢ä¸­ï¼Œç­‰å¾… iframe åŠ è½½å®Œæˆåï¼Œé€šè¿‡è®¿é—®Â <code>iframe.contentWindow.name</code>Â å±æ€§æ¥è·å–å­é¡µé¢ä¸­ä¿å­˜çš„æ•°æ®ã€‚</li></ul><div class="language-js"><button title="Copy Code" class="copy"></button><span class="lang">js</span><pre class="shiki material-theme-palenight"><code><span class="line"><span style="color:#A6ACCD;">iframe</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">onload</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">=</span><span style="color:#A6ACCD;"> </span><span style="color:#C792EA;">function</span><span style="color:#89DDFF;">()</span><span style="color:#A6ACCD;"> </span><span style="color:#89DDFF;">{</span></span>
<span class="line"><span style="color:#F07178;">  </span><span style="color:#C792EA;">const</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">childData</span><span style="color:#F07178;"> </span><span style="color:#89DDFF;">=</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">iframe</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">contentWindow</span><span style="color:#89DDFF;">.</span><span style="color:#A6ACCD;">name</span><span style="color:#89DDFF;">;</span></span>
<span class="line"><span style="color:#F07178;">   </span><span style="color:#A6ACCD;">onsole</span><span style="color:#89DDFF;">.</span><span style="color:#82AAFF;">log</span><span style="color:#F07178;">(</span><span style="color:#89DDFF;">&#39;</span><span style="color:#C3E88D;">message:</span><span style="color:#89DDFF;">&#39;</span><span style="color:#89DDFF;">,</span><span style="color:#F07178;"> </span><span style="color:#A6ACCD;">childData</span><span style="color:#F07178;">)</span><span style="color:#89DDFF;">;</span><span style="color:#F07178;"> </span><span style="color:#676E95;font-style:italic;">// è¾“å‡ºï¼šmessage: Hello Parent!</span></span>
<span class="line"><span style="color:#89DDFF;">};</span></span></code></pre></div><blockquote><p>âš¡âš¡æ³¨æ„ï¼šä½¿ç”¨ <code>window.name</code> è¿›è¡Œè·¨åŸŸ iframe é€šä¿¡å­˜åœ¨å®‰å…¨æ€§é—®é¢˜ï¼Œå› ä¸ºæ‰€æœ‰å…·æœ‰ç›¸åŒåç§°çš„çª—å£éƒ½å¯ä»¥è®¿é—®å’Œä¿®æ”¹ <code>window.name</code>ã€‚</p></blockquote><ol start="4"><li><strong>æœåŠ¡å™¨ç«¯è½¬å‘</strong>ï¼šå¯ä»¥å°†æ¶ˆæ¯ä»ä¸€ä¸ªiframeå‘é€åˆ°æœåŠ¡å™¨ï¼Œç„¶åå†ç”±æœåŠ¡å™¨å°†å…¶è½¬å‘åˆ°å¦ä¸€ä¸ªiframeã€‚âœ¨âœ¨âœ¨</li></ol><blockquote><p>åšå®¢ä¸»è¦è®°å½•ä¸€äº›å­¦ä¹ çš„æ–‡ç« ï¼Œå¦‚æœ‰ä¸è¶³ï¼Œæœ›å¤§å®¶æŒ‡å‡ºï¼Œè°¢è°¢ã€‚</p></blockquote>`,28),e=[p];function t(c,r,D,F,y,i){return a(),n("div",null,e)}const A=s(o,[["render",t]]);export{C as __pageData,A as default};
